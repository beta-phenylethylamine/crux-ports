Just ported over from 6a37 for now, will move to update soon
